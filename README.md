# Telegram-бот для записи на маникюр

Асинхронный Telegram-бот на `aiogram 3` с использованием `SQLite` и `APScheduler`.

## Функционал

- **Запись клиента** через inline-кнопки:
  - выбор даты (в пределах 1 месяца);
  - выбор доступного времени;
  - ввод имени и телефона;
  - подтверждение записи.
- **Ограничение**: один активный слот на пользователя.
- **Отмена записи** пользователем, повторное открытие слота.
- **Прайсы** (кнопка в меню, без FSM).
- **Портфолио** (кнопка в меню с inline-кнопкой-ссылкой).
- **Проверка подписки** на канал перед записью (`getChatMember`).
- **Автонапиоминание** за 24 часа до визита с восстановлением задач при перезапуске.
- **Админ-панель**:
  - добавление рабочих дней и временных слотов;
  - закрытие дня;
  - просмотр расписания на дату.

## Установка

1. **Перейти в папку проекта:**

   ```bash
   cd "c:\Проэкты\zapis_bot"
   ```

2. **Создать и активировать виртуальное окружение (рекомендуется):**

   ```bash
   python -m venv venv
   venv\Scripts\activate
   ```

3. **Установить зависимости:**

   ```bash
   pip install -r requirements.txt
   ```

4. **Настроить переменные окружения:**

   Создайте файл `.env` по образцу `.env.example` и заполните:

   - `BOT_TOKEN` — токен бота от BotFather;
   - `ADMIN_ID` — ваш Telegram ID (числом);
   - `CHANNEL_ID` — ID канала (вида `-100...`, в котором бот является админом);
   - `CHANNEL_LINK` — публичная ссылка на канал (начинается с `https://t.me/...`).

5. **Запустить бота:**

   ```bash
   python bot.py
   ```

6. **Добавить бота в канал:**

   - Добавить бота в указанный канал;
   - выдать ему права на просмотр участников и отправку сообщений.

## Деплой на Render (24/7)

1. Загрузите проект в GitHub.
2. В Render нажмите **New +** -> **Background Worker**.
3. Подключите репозиторий.
4. Укажите:
   - **Build Command**: `pip install -r requirements.txt`
   - **Start Command**: `python bot.py`
5. В разделе **Environment** добавьте переменные:
   - `BOT_TOKEN`
   - `ADMIN_ID`
   - `CHANNEL_ID`
   - `CHANNEL_LINK`
   - `DB_PATH=database.sqlite3`
6. Нажмите **Create Background Worker** и дождитесь статуса `Live`.

> Важно: если токен бота ранее попадал в открытый код, перевыпустите токен в BotFather (`/revoke` -> `/token`).

